<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Applied SNA with R" />
<meta property="og:type" content="book" />


<meta property="og:description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)" />
<meta name="github-repo" content="USCCANA/appliedsnar" />

<meta name="author" content="George G. Vega Yon" />

<meta name="date" content="2018-02-01" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)">

<title>Applied SNA with R</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#prerequisites"><span class="toc-section-number">1</span> Prerequisites</a></li>
<li><a href="2-intro.html#intro"><span class="toc-section-number">2</span> Introduction</a></li>
<li class="has-sub"><a href="3-r-basics.html#r-basics"><span class="toc-section-number">3</span> R Basics</a><ul>
<li><a href="3-1-what-is-r.html#what-is-r"><span class="toc-section-number">3.1</span> What is R</a></li>
<li><a href="3-2-how-to-install-packages.html#how-to-install-packages"><span class="toc-section-number">3.2</span> How to install packages</a></li>
</ul></li>
<li class="has-sub"><a href="4-week-1-sns-study.html#week-1-sns-study"><span class="toc-section-number">4</span> Week 1: SNS Study</a><ul>
<li><a href="4-1-the-social-network-study.html#the-social-network-study"><span class="toc-section-number">4.1</span> The Social Network Study</a></li>
<li><a href="4-2-todays-goals.html#todays-goals"><span class="toc-section-number">4.2</span> Today’s Goals</a></li>
<li class="has-sub"><a href="4-3-data-preprocessing.html#data-preprocessing"><span class="toc-section-number">4.3</span> Data preprocessing</a><ul>
<li><a href="4-3-data-preprocessing.html#reading-the-data-into-r"><span class="toc-section-number">4.3.1</span> Reading the data into R</a></li>
<li><a href="4-3-data-preprocessing.html#creating-a-unique-id-for-each-participant"><span class="toc-section-number">4.3.2</span> Creating a unique id for each participant</a></li>
</ul></li>
<li class="has-sub"><a href="4-4-creating-a-network.html#creating-a-network"><span class="toc-section-number">4.4</span> Creating a network</a><ul>
<li><a href="4-4-creating-a-network.html#from-survey-to-edgelist"><span class="toc-section-number">4.4.1</span> From survey to edgelist</a></li>
<li><a href="4-4-creating-a-network.html#igraph-network"><span class="toc-section-number">4.4.2</span> igraph network</a></li>
</ul></li>
<li><a href="4-5-network-descriptive-stats.html#network-descriptive-stats"><span class="toc-section-number">4.5</span> Network descriptive stats</a></li>
<li class="has-sub"><a href="4-6-plotting-the-network-in-igraph.html#plotting-the-network-in-igraph"><span class="toc-section-number">4.6</span> Plotting the network in igraph</a><ul>
<li><a href="4-6-plotting-the-network-in-igraph.html#single-plot"><span class="toc-section-number">4.6.1</span> Single plot</a></li>
<li><a href="4-6-plotting-the-network-in-igraph.html#multiple-plots"><span class="toc-section-number">4.6.2</span> Multiple plots</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="5-applications.html#applications"><span class="toc-section-number">5</span> Applications</a><ul>
<li><a href="5-1-example-one.html#example-one"><span class="toc-section-number">5.1</span> Example one</a></li>
<li><a href="5-2-example-two.html#example-two"><span class="toc-section-number">5.2</span> Example two</a></li>
</ul></li>
<li><a href="6-final-words.html#final-words"><span class="toc-section-number">6</span> Final Words</a></li>
<li><a href="references.html#references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="plotting-the-network-in-igraph" class="section level2">
<h2><span class="header-section-number">4.6</span> Plotting the network in igraph</h2>
<div id="single-plot" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Single plot</h3>
<ul>
<li></li>
</ul>
<p>Let’s take a look at how does our network looks like when we use the default parameters in the plot method of the igraph object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ig_year1)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:03-plot-raw"></span>
<img src="appliedsnar_files/figure-html/03-plot-raw-1.png" alt="A not very nice network plot. This is what we get with the default parameters in igraph." width="672" />
<p class="caption">
Figure 2.1: A not very nice network plot. This is what we get with the default parameters in igraph.
</p>
</div>
<p>Not very nice, right? A couple of things with this plot:</p>
<ol style="list-style-type: decimal">
<li><p>We are looking at all schools simultaneously, which does not make sense.</p></li>
<li><p>All the vertices have the same size, and more over, are overalaping.</p></li>
<li><p>Given the number of vertices in these networks, the labels are not useful here.</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_hispanic &lt;-<span class="st"> </span><span class="kw">V</span>(ig_year1_<span class="dv">111</span>)<span class="op">$</span>hispanic <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
col_hispanic &lt;-<span class="st"> </span><span class="kw">coalesce</span>(col_hispanic, <span class="dv">3</span>) 
col_hispanic &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;white&quot;</span>)[col_hispanic]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fancy graph</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">plot</span>(
  ig_year1_<span class="dv">111</span>,
  <span class="dt">vertex.size     =</span> <span class="kw">degree</span>(ig_year1_<span class="dv">111</span>)<span class="op">/</span><span class="dv">10</span> <span class="op">+</span><span class="dv">1</span>,
  <span class="dt">vertex.label    =</span> <span class="ot">NA</span>,
  <span class="dt">edge.arrow.size =</span> .<span class="dv">25</span>,
  <span class="dt">layout          =</span> layout_with_fr,
  <span class="dt">vertex.color    =</span> col_hispanic
  )</code></pre></div>
<div class="figure"><span id="fig:03-plot-neat1"></span>
<img src="appliedsnar_files/figure-html/03-plot-neat1-1.png" alt="Friends network in time 1 for school 111. The graph excludes isolates." width="672" />
<p class="caption">
Figure 2.2: Friends network in time 1 for school 111. The graph excludes isolates.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">col_eversmk1 &lt;-<span class="st"> </span><span class="kw">V</span>(ig_year1_<span class="dv">111</span>)<span class="op">$</span>eversmk1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
col_eversmk1 &lt;-<span class="st"> </span><span class="kw">coalesce</span>(col_eversmk1, <span class="dv">3</span>) 
col_eversmk1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;white&quot;</span>)[col_eversmk1]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fancy graph</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">plot</span>(
  ig_year1_<span class="dv">111</span>,
  <span class="dt">vertex.size     =</span> <span class="kw">degree</span>(ig_year1_<span class="dv">111</span>)<span class="op">/</span><span class="dv">10</span> <span class="op">+</span><span class="dv">1</span>,
  <span class="dt">vertex.label    =</span> <span class="ot">NA</span>,
  <span class="dt">edge.arrow.size =</span> .<span class="dv">25</span>,
  <span class="dt">layout          =</span> layout_with_fr,
  <span class="dt">vertex.color    =</span> col_eversmk1
  )</code></pre></div>
<div class="figure"><span id="fig:03-plot-neat2"></span>
<img src="appliedsnar_files/figure-html/03-plot-neat2-1.png" alt="Friends network in time 1 for school 111. The graph excludes isolates." width="672" />
<p class="caption">
Figure 2.3: Friends network in time 1 for school 111. The graph excludes isolates.
</p>
</div>
<p>We can actually write this as a function so that, instead of us copying and pasting the code <span class="math inline">\(n\)</span> times (supposing that we want to crate a plot similar to this <span class="math inline">\(n\)</span> times), we just need t</p>
</div>
<div id="multiple-plots" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Multiple plots</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myplot &lt;-<span class="st"> </span><span class="cf">function</span>(
  net,
  schoolid,
  <span class="dt">mindgr =</span> <span class="dv">1</span>,
  <span class="dt">vcol   =</span> <span class="st">&quot;tomato&quot;</span>,
  ...) {
  
  <span class="co"># Creating a subgraph</span>
  subnet &lt;-<span class="st"> </span><span class="kw">induced_subgraph</span>(
    net,
    <span class="kw">which</span>(<span class="kw">degree</span>(net, <span class="dt">mode =</span> <span class="st">&quot;all&quot;</span>) <span class="op">&gt;=</span><span class="st"> </span>mindgr <span class="op">&amp;</span><span class="st"> </span><span class="kw">V</span>(net)<span class="op">$</span>school <span class="op">==</span><span class="st"> </span>schoolid)
  )
  
  <span class="co"># Computing colors</span>
  
  
  <span class="co"># Fancy graph</span>
  <span class="kw">set.seed</span>(<span class="dv">1</span>)
  <span class="kw">plot</span>(
    subnet,
    <span class="dt">vertex.size     =</span> <span class="kw">degree</span>(subnet)<span class="op">/</span><span class="dv">10</span>,
    <span class="dt">vertex.label    =</span> <span class="ot">NA</span>,
    <span class="dt">edge.arrow.size =</span> .<span class="dv">25</span>,
    <span class="dt">vertex.color    =</span> vcol,
    <span class="dt">layout          =</span> layout_with_fr,
    ...
    )
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plotting all together</span>
oldpar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">mai =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">oma=</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))
<span class="kw">myplot</span>(ig_year1, <span class="dv">111</span>, <span class="dt">vcol =</span> <span class="st">&quot;tomato&quot;</span>)
<span class="kw">myplot</span>(ig_year1, <span class="dv">112</span>, <span class="dt">vcol =</span> <span class="st">&quot;steelblue&quot;</span>)
<span class="kw">myplot</span>(ig_year1, <span class="dv">113</span>, <span class="dt">vcol =</span> <span class="st">&quot;black&quot;</span>)
<span class="kw">myplot</span>(ig_year1, <span class="dv">114</span>, <span class="dt">vcol =</span> <span class="st">&quot;gold&quot;</span>)
<span class="kw">myplot</span>(ig_year1, <span class="dv">115</span>, <span class="dt">vcol =</span> <span class="st">&quot;white&quot;</span>)
<span class="kw">par</span>(oldpar)

<span class="co"># A fancy legend</span>
<span class="kw">legend</span>(
  <span class="st">&quot;bottomright&quot;</span>,
  <span class="dt">legend =</span> <span class="kw">c</span>(<span class="dv">111</span>, <span class="dv">112</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>),
  <span class="dt">pt.bg  =</span> <span class="kw">c</span>(<span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;gold&quot;</span>, <span class="st">&quot;white&quot;</span>),
  <span class="dt">pch    =</span> <span class="dv">21</span>,
  <span class="dt">cex    =</span> <span class="dv">1</span>,
  <span class="dt">bty    =</span> <span class="st">&quot;n&quot;</span>,
  <span class="dt">title  =</span> <span class="st">&quot;School&quot;</span>
  )</code></pre></div>
<div class="figure"><span id="fig:03-myplot-call"></span>
<img src="appliedsnar_files/figure-html/03-myplot-call-1.png" alt="All 5 schools in time 1. Again, the graphs exclude isolates." width="672" />
<p class="caption">
Figure 2.4: All 5 schools in time 1. Again, the graphs exclude isolates.
</p>
</div>
<ul>
<li><p><code>oldpar &lt;- par(no.readonly = TRUE)</code> This line stores the current parameters for plotting. Since we are going to be changing them, we better make sure we are able to go back!.</p></li>
<li><p><code>par(mfrow = c(2, 3), mai = rep(0, 4), oma=rep(0, 4))</code> Here we are setting various things at the same time. <code>mfrow</code> specifies how many <em>figures</em> will be drawn and in what order, in particular, we are asking the plotting device to allow for 2*3 = 6 plots organized in 2 rows and 3 columns, and these will be drawn by row.</p>
<p><code>mai</code> specifies the size of the margins in inches. Setting all margins equal to zero (which is what we are doing now) gives more space to the network itself. The same is true for <code>oma</code>. See <code>?par</code> for more info.</p></li>
<li><p><code>myplot(ig_year1, ...)</code> This is simply calling our plotting function. The neat part of this is that, since we set <code>mfrow = c(2, 3)</code>, R takes care of <em>distributing</em> the plots in the device.</p></li>
<li><p><code>par(oldpar)</code> Finally, this line allows us to restore the plotting parameters.</p></li>
</ul>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="4-5-network-descriptive-stats.html"><button class="btn btn-default">Previous</button></a>
<a href="5-applications.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
