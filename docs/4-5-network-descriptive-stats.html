<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Applied SNA with R" />
<meta property="og:type" content="book" />


<meta property="og:description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)" />
<meta name="github-repo" content="USCCANA/appliedsnar" />

<meta name="author" content="George G. Vega Yon" />

<meta name="date" content="2018-02-02" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="An improvised book on applied Social Network Analysis with R, this is(will be) a compilation of the materials presented in this series of workshop hosted by USC’s Center for Applied Network Analysis (CANA)">

<title>Applied SNA with R</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#prerequisites"><span class="toc-section-number">1</span> Prerequisites</a></li>
<li><a href="2-intro.html#intro"><span class="toc-section-number">2</span> Introduction</a></li>
<li class="has-sub"><a href="3-r-basics.html#r-basics"><span class="toc-section-number">3</span> R Basics</a><ul>
<li><a href="3-1-what-is-r.html#what-is-r"><span class="toc-section-number">3.1</span> What is R</a></li>
<li><a href="3-2-how-to-install-packages.html#how-to-install-packages"><span class="toc-section-number">3.2</span> How to install packages</a></li>
</ul></li>
<li class="has-sub"><a href="4-week-1-sns-study.html#week-1-sns-study"><span class="toc-section-number">4</span> Week 1: SNS Study</a><ul>
<li><a href="4-1-the-social-network-study.html#the-social-network-study"><span class="toc-section-number">4.1</span> The Social Network Study</a></li>
<li><a href="4-2-todays-goals.html#todays-goals"><span class="toc-section-number">4.2</span> Today’s Goals</a></li>
<li class="has-sub"><a href="4-3-data-preprocessing.html#data-preprocessing"><span class="toc-section-number">4.3</span> Data preprocessing</a><ul>
<li><a href="4-3-data-preprocessing.html#reading-the-data-into-r"><span class="toc-section-number">4.3.1</span> Reading the data into R</a></li>
<li><a href="4-3-data-preprocessing.html#creating-a-unique-id-for-each-participant"><span class="toc-section-number">4.3.2</span> Creating a unique id for each participant</a></li>
</ul></li>
<li class="has-sub"><a href="4-4-creating-a-network.html#creating-a-network"><span class="toc-section-number">4.4</span> Creating a network</a><ul>
<li><a href="4-4-creating-a-network.html#from-survey-to-edgelist"><span class="toc-section-number">4.4.1</span> From survey to edgelist</a></li>
<li><a href="4-4-creating-a-network.html#igraph-network"><span class="toc-section-number">4.4.2</span> igraph network</a></li>
</ul></li>
<li><a href="4-5-network-descriptive-stats.html#network-descriptive-stats"><span class="toc-section-number">4.5</span> Network descriptive stats</a></li>
<li class="has-sub"><a href="4-6-plotting-the-network-in-igraph.html#plotting-the-network-in-igraph"><span class="toc-section-number">4.6</span> Plotting the network in igraph</a><ul>
<li><a href="4-6-plotting-the-network-in-igraph.html#single-plot"><span class="toc-section-number">4.6.1</span> Single plot</a></li>
<li><a href="4-6-plotting-the-network-in-igraph.html#multiple-plots"><span class="toc-section-number">4.6.2</span> Multiple plots</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="5-applications.html#applications"><span class="toc-section-number">5</span> Applications</a><ul>
<li><a href="5-1-example-one.html#example-one"><span class="toc-section-number">5.1</span> Example one</a></li>
<li><a href="5-2-example-two.html#example-two"><span class="toc-section-number">5.2</span> Example two</a></li>
</ul></li>
<li><a href="6-final-words.html#final-words"><span class="toc-section-number">6</span> Final Words</a></li>
<li><a href="references.html#references">References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="has-sub"><a href="A-datasets.html#datasets"><span class="toc-section-number">A</span> Datasets</a><ul>
<li class="has-sub"><a href="A-1-sns-data.html#sns-data"><span class="toc-section-number">A.1</span> SNS data</a><ul>
<li><a href="A-1-sns-data.html#about-the-data"><span class="toc-section-number">A.1.1</span> About the data</a></li>
<li><a href="A-1-sns-data.html#variables"><span class="toc-section-number">A.1.2</span> Variables</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="network-descriptive-stats" class="section level2">
<h2><span class="header-section-number">4.5</span> Network descriptive stats</h2>
<p>While we could do all networks at once, in this part we will focus on computing some network statistics for one of the schools only. We start by school 111. The first question that you should be asking your self now is, “how can I get that information from the igraph object?.” Well, vertex attributes and edges attributes can be accessed via the <code>V</code> and <code>E</code> functions respectively; moreover, we can list what vertex/edge attributes are available:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.vertex.attributes</span>(ig_year1)</code></pre></div>
<pre><code>## [1] &quot;name&quot;     &quot;school&quot;   &quot;hispanic&quot; &quot;female1&quot;  &quot;eversmk1&quot; &quot;eversmk2&quot;
## [7] &quot;eversmk3&quot; &quot;eversmk4&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list.edge.attributes</span>(ig_year1) <span class="co"># we have no edge attributes here</span></code></pre></div>
<pre><code>## character(0)</code></pre>
<p>Just like we would do with data frames, accessing vertex attributes is done via the dollar sign operator <code>$</code> together with the <code>V</code> function, for example, accessing the first 10 elements of the variable <code>hispanic</code> can be done as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">V</span>(ig_year1)<span class="op">$</span>hispanic[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##  [1] 1 1 0 1 1 1 1 1 0 1</code></pre>
<p>Now that you know how to access vertex attributes, we can get the network corresponding to school 111 by identifying which vertices are part of it and pass that information to the <code>induced_subgraph</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Which ids are from school 111?</span>
school111ids &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">V</span>(ig_year1)<span class="op">$</span>school <span class="op">==</span><span class="st"> </span><span class="dv">111</span>)

<span class="co"># Creating a subgraph</span>
ig_year1_<span class="dv">111</span> &lt;-<span class="st"> </span><span class="kw">induced_subgraph</span>(
  <span class="dt">graph =</span> ig_year1,
  <span class="dt">vids  =</span> school111ids
)</code></pre></div>
<p>The <code>which</code> function in R returns a vector of indices indicating which elements are true. In our case it will return a vector of indices of the vertices which have the attribute <code>school</code> equal to 111. Now that we have our subgraph, we can compute different centrality measures<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> for each vertex and store them in the igraph object itself:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Computing centrality measures for each vertex</span>
<span class="kw">V</span>(ig_year1_<span class="dv">111</span>)<span class="op">$</span>indegree   &lt;-<span class="st"> </span><span class="kw">degree</span>(ig_year1_<span class="dv">111</span>, <span class="dt">mode =</span> <span class="st">&quot;in&quot;</span>)
<span class="kw">V</span>(ig_year1_<span class="dv">111</span>)<span class="op">$</span>outdegree  &lt;-<span class="st"> </span><span class="kw">degree</span>(ig_year1_<span class="dv">111</span>, <span class="dt">mode =</span> <span class="st">&quot;out&quot;</span>)
<span class="kw">V</span>(ig_year1_<span class="dv">111</span>)<span class="op">$</span>closeness  &lt;-<span class="st"> </span><span class="kw">closeness</span>(ig_year1_<span class="dv">111</span>, <span class="dt">mode =</span> <span class="st">&quot;total&quot;</span>)
<span class="kw">V</span>(ig_year1_<span class="dv">111</span>)<span class="op">$</span>betweeness &lt;-<span class="st"> </span><span class="kw">betweenness</span>(ig_year1_<span class="dv">111</span>, <span class="dt">normalized =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>From here, we can <em>go back</em> to our old habits and get the set of vertex attributes as a data frame so we can compute some summary statistics on the centrality measurements that we just got</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extracting each vectex features as a data.frame</span>
stats &lt;-<span class="st"> </span><span class="kw">as_data_frame</span>(ig_year1_<span class="dv">111</span>, <span class="dt">what =</span> <span class="st">&quot;vertices&quot;</span>)

<span class="co"># Computing quantiles for each variable</span>
stats_degree &lt;-<span class="st"> </span><span class="kw">with</span>(stats, {
 <span class="kw">cbind</span>(
   <span class="dt">indegree   =</span> <span class="kw">quantile</span>(indegree, <span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>)),
   <span class="dt">outdegree  =</span> <span class="kw">quantile</span>(outdegree, <span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>)),
   <span class="dt">closeness  =</span> <span class="kw">quantile</span>(closeness, <span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>)),
   <span class="dt">betweeness =</span> <span class="kw">quantile</span>(betweeness, <span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>))
 )
})

stats_degree</code></pre></div>
<pre><code>##       indegree outdegree    closeness  betweeness
## 2.5%         0         0 3.526640e-06 0.000000000
## 50%          4         4 1.595431e-05 0.001879006
## 97.5%       16        16 1.601822e-05 0.016591048</code></pre>
<p>The <code>with</code> function is somewhat similar to what <code>dplyr</code> allows us to do when we want to work with the dataset but without mentioning its name everytime that we ask for a variable. Without using the <code>with</code> function, the previous could have been done as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stats_degree &lt;-<span class="st"> </span>
<span class="st"> </span><span class="kw">cbind</span>(
   <span class="dt">indegree   =</span> <span class="kw">quantile</span>(stats<span class="op">$</span>indegree, <span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>)),
   <span class="dt">outdegree  =</span> <span class="kw">quantile</span>(stats<span class="op">$</span>outdegree, <span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>)),
   <span class="dt">closeness  =</span> <span class="kw">quantile</span>(stats<span class="op">$</span>closeness, <span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>)),
   <span class="dt">betweeness =</span> <span class="kw">quantile</span>(stats<span class="op">$</span>betweeness, <span class="kw">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, .<span class="dv">975</span>))
 )</code></pre></div>
<p>Now we will compute some statistics at the graph level:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(
  <span class="dt">size    =</span> <span class="kw">vcount</span>(ig_year1_<span class="dv">111</span>),
  <span class="dt">nedges  =</span> <span class="kw">ecount</span>(ig_year1_<span class="dv">111</span>),
  <span class="dt">density =</span> <span class="kw">edge_density</span>(ig_year1_<span class="dv">111</span>),
  <span class="dt">recip   =</span> <span class="kw">reciprocity</span>(ig_year1_<span class="dv">111</span>),
  <span class="dt">centr   =</span> <span class="kw">centr_betw</span>(ig_year1_<span class="dv">111</span>)<span class="op">$</span>centralization,
  <span class="dt">pathLen =</span> <span class="kw">mean_distance</span>(ig_year1_<span class="dv">111</span>)
  )</code></pre></div>
<pre><code>##      size nedges     density     recip      centr pathLen
## [1,]  533   2638 0.009303277 0.3731513 0.02179154 4.23678</code></pre>
<p>Triadic census</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">triadic &lt;-<span class="st"> </span><span class="kw">triad_census</span>(ig_year1_<span class="dv">111</span>)
triadic</code></pre></div>
<pre><code>##  [1] 24059676   724389   290849     3619     3383     4401     3219
##  [8]     2997      407       33      836      235      163      137
## [15]      277       85</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(
  <span class="dt">Pcent =</span> triadic<span class="op">/</span><span class="kw">sum</span>(triadic)<span class="op">*</span><span class="dv">100</span>,
  <span class="kw">read.csv</span>(<span class="st">&quot;triadic_census.csv&quot;</span>)
  ), <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Pcent</th>
<th align="left">code</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">95.88</td>
<td align="left">003</td>
<td align="left">A,B,C, the empty graph.</td>
</tr>
<tr class="even">
<td align="right">2.89</td>
<td align="left">012</td>
<td align="left">A-&gt;B, C, the graph with a single directed edge.</td>
</tr>
<tr class="odd">
<td align="right">1.16</td>
<td align="left">102</td>
<td align="left">A&lt;-&gt;B, C, the graph with a mutual connection between two vertices.</td>
</tr>
<tr class="even">
<td align="right">0.01</td>
<td align="left">021D</td>
<td align="left">A&lt;-B-&gt;C, the out-star.</td>
</tr>
<tr class="odd">
<td align="right">0.01</td>
<td align="left">021U</td>
<td align="left">A-&gt;B&lt;-C, the in-star.</td>
</tr>
<tr class="even">
<td align="right">0.02</td>
<td align="left">021C</td>
<td align="left">A-&gt;B-&gt;C, directed line.</td>
</tr>
<tr class="odd">
<td align="right">0.01</td>
<td align="left">111D</td>
<td align="left">A&lt;-&gt;B&lt;-C.</td>
</tr>
<tr class="even">
<td align="right">0.01</td>
<td align="left">111U</td>
<td align="left">A&lt;-&gt;B-&gt;C.</td>
</tr>
<tr class="odd">
<td align="right">0.00</td>
<td align="left">030T</td>
<td align="left">A-&gt;B&lt;-C, A-&gt;C.</td>
</tr>
<tr class="even">
<td align="right">0.00</td>
<td align="left">030C</td>
<td align="left">A&lt;-B&lt;-C, A-&gt;C.</td>
</tr>
<tr class="odd">
<td align="right">0.00</td>
<td align="left">201</td>
<td align="left">A&lt;-&gt;B&lt;-&gt;C.</td>
</tr>
<tr class="even">
<td align="right">0.00</td>
<td align="left">120D</td>
<td align="left">A&lt;-B-&gt;C, A&lt;-&gt;C.</td>
</tr>
<tr class="odd">
<td align="right">0.00</td>
<td align="left">120U</td>
<td align="left">A-&gt;B&lt;-C, A&lt;-&gt;C.</td>
</tr>
<tr class="even">
<td align="right">0.00</td>
<td align="left">120C</td>
<td align="left">A-&gt;B-&gt;C, A&lt;-&gt;C.</td>
</tr>
<tr class="odd">
<td align="right">0.00</td>
<td align="left">210</td>
<td align="left">A-&gt;B&lt;-&gt;C, A&lt;-&gt;C.</td>
</tr>
<tr class="even">
<td align="right">0.00</td>
<td align="left">300</td>
<td align="left">A&lt;-&gt;B&lt;-&gt;C, A&lt;-&gt;C, the complete graph.</td>
</tr>
</tbody>
</table>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>For more information about the different centrality measurements, please take a look at the “Centrality” article on <a href="https://en.wikipedia.org/wiki/Centrality">Wikipedia</a>.<a href="4-5-network-descriptive-stats.html#fnref2">↩</a></p></li>
</ol>
</div>
<p style="text-align: center;">
<a href="4-4-creating-a-network.html"><button class="btn btn-default">Previous</button></a>
<a href="4-6-plotting-the-network-in-igraph.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
<!-- </html> -->
